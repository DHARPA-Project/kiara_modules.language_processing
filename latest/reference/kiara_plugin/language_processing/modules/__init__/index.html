
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Markus Binsteiner">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.8">
    
    
      
        <title>modules - kiara_plugin.language_processing</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kiara_plugin.language_processing.modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="kiara_plugin.language_processing" class="md-header__button md-logo" aria-label="kiara_plugin.language_processing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kiara_plugin.language_processing
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              modules
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DHARPA-Project/kiara_plugin.language_processing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="kiara_plugin.language_processing" class="md-nav__button md-logo" aria-label="kiara_plugin.language_processing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    kiara_plugin.language_processing
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DHARPA-Project/kiara_plugin.language_processing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Package contents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Package contents" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Package contents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/module_types/" class="md-nav__link">
        module_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/operations/" class="md-nav__link">
        operations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../development/" class="md-nav__link">
        Development
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          API reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          kiara_plugin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="kiara_plugin" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          kiara_plugin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1_1" type="checkbox" id="__nav_5_1_1" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../__init__/">language_processing</a>
          
            <label for="__nav_5_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="language_processing" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_1_1">
          <span class="md-nav__icon md-icon"></span>
          language_processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_types/" class="md-nav__link">
        data_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/" class="md-nav__link">
        models
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1_1_3" type="checkbox" id="__nav_5_1_1_3" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">modules</a>
          
            <label for="__nav_5_1_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="modules" data-md-level="4">
        <label class="md-nav__title" for="__nav_5_1_1_3">
          <span class="md-nav__icon md-icon"></span>
          modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lda/" class="md-nav__link">
        lda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lemmatize/" class="md-nav__link">
        lemmatize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tokens/" class="md-nav__link">
        tokens
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/__init__/" class="md-nav__link">
        pipelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules" class="md-nav__link">
    kiara_plugin.language_processing.modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules-modules" class="md-nav__link">
    Modules
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.lda" class="md-nav__link">
    lda
  </a>
  
    <nav class="md-nav" aria-label="lda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.lda-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.lda.LDAModule" class="md-nav__link">
    LDAModule
  </a>
  
    <nav class="md-nav" aria-label="LDAModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.lda.LDAModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.lemmatize" class="md-nav__link">
    lemmatize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens" class="md-nav__link">
    tokens
  </a>
  
    <nav class="md-nav" aria-label="tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.log" class="md-nav__link">
    log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule" class="md-nav__link">
    AssembleStopwordsModule
  </a>
  
    <nav class="md-nav" aria-label="AssembleStopwordsModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule" class="md-nav__link">
    PreprocessModule
  </a>
  
    <nav class="md-nav" aria-label="PreprocessModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule" class="md-nav__link">
    RemoveStopwordsModule
  </a>
  
    <nav class="md-nav" aria-label="RemoveStopwordsModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule" class="md-nav__link">
    TokenizeTextArrayeModule
  </a>
  
    <nav class="md-nav" aria-label="TokenizeTextArrayeModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig" class="md-nav__link">
    TokenizeTextConfig
  </a>
  
    <nav class="md-nav" aria-label="TokenizeTextConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig-attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule" class="md-nav__link">
    TokenizeTextModule
  </a>
  
    <nav class="md-nav" aria-label="TokenizeTextModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-classes" class="md-nav__link">
    Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.language_processing.modules.tokens.get_stopwords" class="md-nav__link">
    get_stopwords()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/DHARPA-Project/edit/master/docs/src/kiara_plugin/language_processing/modules/__init__.py" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>modules</h1>

<div class="doc doc-object doc-module">

<a id="kiara_plugin.language_processing.modules"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">








<h2 id="kiara_plugin.language_processing.modules-modules">Modules<a href="#kiara_plugin.language_processing.modules-modules" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-object doc-module">



<h3 id="kiara_plugin.language_processing.modules.lda" class="doc doc-heading">
        <code>lda</code>



<a href="#kiara_plugin.language_processing.modules.lda" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">





<h4 id="kiara_plugin.language_processing.modules.lda-classes">Classes<a href="#kiara_plugin.language_processing.modules.lda-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.lda.LDAModule" class="doc doc-heading">
        <code>
LDAModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.lda.LDAModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Perform Latent Dirichlet Allocation on a tokenized corpus.</p>
<p>This module computes models for a range of number of topics provided by the user.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LDAModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform Latent Dirichlet Allocation on a tokenized corpus.</span>

<span class="sd">    This module computes models for a range of number of topics provided by the user.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;generate.LDA.for.tokens_array&quot;</span>

    <span class="n">KIARA_METADATA</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;LDA&quot;</span><span class="p">,</span> <span class="s2">&quot;tokens&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="n">inputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The text corpus.&quot;</span><span class="p">},</span>
            <span class="s2">&quot;num_topics_min&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The minimal number of topics.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;num_topics_max&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The max number of topics.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;compute_coherence&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Whether to compute the coherence score for each model.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;words_per_topic&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;How many words per topic to put in the result model.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">inputs</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;topic_models&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A dictionary with one coherence model table for each number of topics.&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;coherence_table&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Coherence details.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;coherence_map&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A map with the coherence value for every number of topics.&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">,</span> <span class="n">num_topics</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">id2word</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">LdaModel</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">LdaModel</span><span class="p">(</span>
            <span class="n">corpus</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">num_topics</span><span class="p">,</span> <span class="n">eval_every</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">compute_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">corpus_model</span><span class="p">,</span> <span class="n">id2word</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>

        <span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">CoherenceModel</span>

        <span class="n">coherencemodel</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">texts</span><span class="o">=</span><span class="n">corpus_model</span><span class="p">,</span>
            <span class="n">dictionary</span><span class="o">=</span><span class="n">id2word</span><span class="p">,</span>
            <span class="n">coherence</span><span class="o">=</span><span class="s2">&quot;c_v&quot;</span><span class="p">,</span>
            <span class="n">processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">coherence_value</span> <span class="o">=</span> <span class="n">coherencemodel</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">coherence_value</span>

    <span class="k">def</span> <span class="nf">assemble_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">words_per_topic</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

        <span class="c1"># Create list with topics and topic words for each number of topics</span>
        <span class="n">num_topics_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">topics_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">num_topics</span><span class="p">,</span>
            <span class="n">model</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">num_topics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_topics</span><span class="p">)</span>
            <span class="n">topic_print</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">words_per_topic</span><span class="p">)</span>
            <span class="n">topics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topic_print</span><span class="p">)</span>

        <span class="n">df_coherence_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;topic_id&quot;</span><span class="p">,</span> <span class="s2">&quot;words&quot;</span><span class="p">,</span> <span class="s2">&quot;num_topics&quot;</span><span class="p">])</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topics_list</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                <span class="n">df_coherence_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;topic_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;words&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;(\w+)&quot;&#39;</span><span class="p">,</span> <span class="n">topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">)</span>
                <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;num_topics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">coherence_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_coherence_table</span><span class="p">,</span> <span class="n">preserve_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coherence_table</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">gensim</span> <span class="kn">import</span> <span class="n">corpora</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;gensim&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
        <span class="n">tokens_array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens_array</span><span class="o">.</span><span class="n">arrow_array</span><span class="o">.</span><span class="n">to_pylist</span><span class="p">()</span>

        <span class="n">words_per_topic</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;words_per_topic&quot;</span><span class="p">)</span>

        <span class="n">num_topics_min</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;num_topics_min&quot;</span><span class="p">)</span>
        <span class="n">num_topics_max</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;num_topics_max&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_topics_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num_topics_max</span> <span class="o">=</span> <span class="n">num_topics_min</span>

        <span class="n">compute_coherence</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;compute_coherence&quot;</span><span class="p">)</span>
        <span class="n">id2word</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
        <span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">id2word</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>

        <span class="c1"># model = gensim.models.ldamulticore.LdaMulticore(</span>
        <span class="c1">#     corpus, id2word=id2word, num_topics=num_topics, eval_every=None</span>
        <span class="c1"># )</span>

        <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">model_tables</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">coherence</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># multi_threaded = False</span>
        <span class="c1"># if not multi_threaded:</span>

        <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_topics_min</span><span class="p">,</span> <span class="n">num_topics_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span><span class="p">)</span>
            <span class="n">models</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
            <span class="n">topic_print_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">words_per_topic</span><span class="p">)</span>
            <span class="c1"># dbg(topic_print_model)</span>
            <span class="c1"># df = pd.DataFrame(topic_print_model, columns=[&quot;topic_id&quot;, &quot;words&quot;])</span>
            <span class="c1"># TODO: create table directly</span>
            <span class="c1"># result_table = Table.from_pandas(df)</span>
            <span class="n">model_tables</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">topic_print_model</span>

            <span class="k">if</span> <span class="n">compute_coherence</span><span class="p">:</span>
                <span class="n">coherence_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_coherence</span><span class="p">(</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">corpus_model</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span>
                <span class="p">)</span>
                <span class="n">coherence</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">coherence_result</span>

        <span class="c1"># else:</span>
        <span class="c1">#     def create_model(num_topics):</span>
        <span class="c1">#         model = self.create_model(corpus=corpus, num_topics=num_topics, id2word=id2word)</span>
        <span class="c1">#         topic_print_model = model.print_topics(num_words=30)</span>
        <span class="c1">#         df = pd.DataFrame(topic_print_model, columns=[&quot;topic_id&quot;, &quot;words&quot;])</span>
        <span class="c1">#         # TODO: create table directly</span>
        <span class="c1">#         result_table = Table.from_pandas(df)</span>
        <span class="c1">#         coherence_result = None</span>
        <span class="c1">#         if compute_coherence:</span>
        <span class="c1">#             coherence_result = self.compute_coherence(model=model, corpus_model=tokens, id2word=id2word)</span>
        <span class="c1">#         return (num_topics, model, result_table, coherence_result)</span>
        <span class="c1">#</span>
        <span class="c1">#     executor = ThreadPoolExecutor()</span>
        <span class="c1">#     results: typing.Any = executor.map(create_model, range(num_topics_min, num_topics_max+1))</span>
        <span class="c1">#     executor.shutdown(wait=True)</span>
        <span class="c1">#     for r in results:</span>
        <span class="c1">#         models[r[0]] = r[1]</span>
        <span class="c1">#         model_tables[r[0]] = r[2]</span>
        <span class="c1">#         if compute_coherence:</span>
        <span class="c1">#             coherence[r[0]] = r[3]</span>

        <span class="c1"># df_coherence = pd.DataFrame(coherence.keys(), columns=[&quot;Number of topics&quot;])</span>
        <span class="c1"># df_coherence[&quot;Coherence&quot;] = coherence.values()</span>

        <span class="k">if</span> <span class="n">compute_coherence</span><span class="p">:</span>
            <span class="n">coherence_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assemble_coherence</span><span class="p">(</span>
                <span class="n">models_dict</span><span class="o">=</span><span class="n">models</span><span class="p">,</span> <span class="n">words_per_topic</span><span class="o">=</span><span class="n">words_per_topic</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coherence_table</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">coherence_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coherence</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
            <span class="n">topic_models</span><span class="o">=</span><span class="n">model_tables</span><span class="p">,</span>
            <span class="n">coherence_table</span><span class="o">=</span><span class="n">coherence_table</span><span class="p">,</span>
            <span class="n">coherence_map</span><span class="o">=</span><span class="n">coherence_map</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.KIARA_METADATA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KIARA_METADATA</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.KIARA_METADATA" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>




<h6 id="kiara_plugin.language_processing.modules.lda.LDAModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.lda.LDAModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.assemble_coherence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assemble_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models_dict</span><span class="p">,</span> <span class="n">words_per_topic</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.assemble_coherence" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">assemble_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">words_per_topic</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

    <span class="c1"># Create list with topics and topic words for each number of topics</span>
    <span class="n">num_topics_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topics_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span>
        <span class="n">num_topics</span><span class="p">,</span>
        <span class="n">model</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">num_topics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_topics</span><span class="p">)</span>
        <span class="n">topic_print</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">words_per_topic</span><span class="p">)</span>
        <span class="n">topics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topic_print</span><span class="p">)</span>

    <span class="n">df_coherence_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;topic_id&quot;</span><span class="p">,</span> <span class="s2">&quot;words&quot;</span><span class="p">,</span> <span class="s2">&quot;num_topics&quot;</span><span class="p">])</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topics_list</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="n">df_coherence_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;topic_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;words&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;(\w+)&quot;&#39;</span><span class="p">,</span> <span class="n">topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">df_coherence_table</span><span class="p">[</span><span class="s2">&quot;num_topics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_topics_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">coherence_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_coherence_table</span><span class="p">,</span> <span class="n">preserve_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coherence_table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.compute_coherence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">corpus_model</span><span class="p">,</span> <span class="n">id2word</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.compute_coherence" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">corpus_model</span><span class="p">,</span> <span class="n">id2word</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>

    <span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">CoherenceModel</span>

    <span class="n">coherencemodel</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">texts</span><span class="o">=</span><span class="n">corpus_model</span><span class="p">,</span>
        <span class="n">dictionary</span><span class="o">=</span><span class="n">id2word</span><span class="p">,</span>
        <span class="n">coherence</span><span class="o">=</span><span class="s2">&quot;c_v&quot;</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">coherence_value</span> <span class="o">=</span> <span class="n">coherencemodel</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">coherence_value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="n">inputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The text corpus.&quot;</span><span class="p">},</span>
        <span class="s2">&quot;num_topics_min&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The minimal number of topics.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;num_topics_max&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The max number of topics.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;compute_coherence&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Whether to compute the coherence score for each model.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;words_per_topic&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;How many words per topic to put in the result model.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.create_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">,</span> <span class="n">num_topics</span><span class="p">,</span> <span class="n">id2word</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.create_model" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">,</span> <span class="n">num_topics</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">id2word</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
    <span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">LdaModel</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">LdaModel</span><span class="p">(</span>
        <span class="n">corpus</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">num_topics</span><span class="p">,</span> <span class="n">eval_every</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;topic_models&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A dictionary with one coherence model table for each number of topics.&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;coherence_table&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Coherence details.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;coherence_map&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A map with the coherence value for every number of topics.&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.lda.LDAModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.lda.LDAModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/lda.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">gensim</span> <span class="kn">import</span> <span class="n">corpora</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;gensim&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
    <span class="n">tokens_array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens_array</span><span class="o">.</span><span class="n">arrow_array</span><span class="o">.</span><span class="n">to_pylist</span><span class="p">()</span>

    <span class="n">words_per_topic</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;words_per_topic&quot;</span><span class="p">)</span>

    <span class="n">num_topics_min</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;num_topics_min&quot;</span><span class="p">)</span>
    <span class="n">num_topics_max</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;num_topics_max&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_topics_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_topics_max</span> <span class="o">=</span> <span class="n">num_topics_min</span>

    <span class="n">compute_coherence</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;compute_coherence&quot;</span><span class="p">)</span>
    <span class="n">id2word</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
    <span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">id2word</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>

    <span class="c1"># model = gensim.models.ldamulticore.LdaMulticore(</span>
    <span class="c1">#     corpus, id2word=id2word, num_topics=num_topics, eval_every=None</span>
    <span class="c1"># )</span>

    <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">model_tables</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">coherence</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># multi_threaded = False</span>
    <span class="c1"># if not multi_threaded:</span>

    <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_topics_min</span><span class="p">,</span> <span class="n">num_topics_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span><span class="p">)</span>
        <span class="n">models</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
        <span class="n">topic_print_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">words_per_topic</span><span class="p">)</span>
        <span class="c1"># dbg(topic_print_model)</span>
        <span class="c1"># df = pd.DataFrame(topic_print_model, columns=[&quot;topic_id&quot;, &quot;words&quot;])</span>
        <span class="c1"># TODO: create table directly</span>
        <span class="c1"># result_table = Table.from_pandas(df)</span>
        <span class="n">model_tables</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">topic_print_model</span>

        <span class="k">if</span> <span class="n">compute_coherence</span><span class="p">:</span>
            <span class="n">coherence_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_coherence</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">corpus_model</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">id2word</span>
            <span class="p">)</span>
            <span class="n">coherence</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">coherence_result</span>

    <span class="c1"># else:</span>
    <span class="c1">#     def create_model(num_topics):</span>
    <span class="c1">#         model = self.create_model(corpus=corpus, num_topics=num_topics, id2word=id2word)</span>
    <span class="c1">#         topic_print_model = model.print_topics(num_words=30)</span>
    <span class="c1">#         df = pd.DataFrame(topic_print_model, columns=[&quot;topic_id&quot;, &quot;words&quot;])</span>
    <span class="c1">#         # TODO: create table directly</span>
    <span class="c1">#         result_table = Table.from_pandas(df)</span>
    <span class="c1">#         coherence_result = None</span>
    <span class="c1">#         if compute_coherence:</span>
    <span class="c1">#             coherence_result = self.compute_coherence(model=model, corpus_model=tokens, id2word=id2word)</span>
    <span class="c1">#         return (num_topics, model, result_table, coherence_result)</span>
    <span class="c1">#</span>
    <span class="c1">#     executor = ThreadPoolExecutor()</span>
    <span class="c1">#     results: typing.Any = executor.map(create_model, range(num_topics_min, num_topics_max+1))</span>
    <span class="c1">#     executor.shutdown(wait=True)</span>
    <span class="c1">#     for r in results:</span>
    <span class="c1">#         models[r[0]] = r[1]</span>
    <span class="c1">#         model_tables[r[0]] = r[2]</span>
    <span class="c1">#         if compute_coherence:</span>
    <span class="c1">#             coherence[r[0]] = r[3]</span>

    <span class="c1"># df_coherence = pd.DataFrame(coherence.keys(), columns=[&quot;Number of topics&quot;])</span>
    <span class="c1"># df_coherence[&quot;Coherence&quot;] = coherence.values()</span>

    <span class="k">if</span> <span class="n">compute_coherence</span><span class="p">:</span>
        <span class="n">coherence_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assemble_coherence</span><span class="p">(</span>
            <span class="n">models_dict</span><span class="o">=</span><span class="n">models</span><span class="p">,</span> <span class="n">words_per_topic</span><span class="o">=</span><span class="n">words_per_topic</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coherence_table</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">coherence_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coherence</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
        <span class="n">topic_models</span><span class="o">=</span><span class="n">model_tables</span><span class="p">,</span>
        <span class="n">coherence_table</span><span class="o">=</span><span class="n">coherence_table</span><span class="p">,</span>
        <span class="n">coherence_map</span><span class="o">=</span><span class="n">coherence_map</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara_plugin.language_processing.modules.lemmatize" class="doc doc-heading">
        <code>lemmatize</code>



<a href="#kiara_plugin.language_processing.modules.lemmatize" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara_plugin.language_processing.modules.tokens" class="doc doc-heading">
        <code>tokens</code>



<a href="#kiara_plugin.language_processing.modules.tokens" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.language_processing.modules.tokens.log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.log" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>


<h4 id="kiara_plugin.language_processing.modules.tokens-classes">Classes<a href="#kiara_plugin.language_processing.modules.tokens-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule" class="doc doc-heading">
        <code>
AssembleStopwordsModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Create a list of stopwords from one or multiple sources.</p>
<p>This will download nltk stopwords if necessary, and merge all input lists into a single, sorted list without duplicates.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AssembleStopwordsModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a list of stopwords from one or multiple sources.</span>

<span class="sd">    This will download nltk stopwords if necessary, and merge all input lists into a single, sorted list without duplicates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;create.stopwords_list&quot;</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;languages&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of languages, will be used to retrieve language-specific stopword from nltk.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;stopword_lists&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of lists of stopwords.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;stopwords_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A sorted list of unique stopwords.&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

        <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">_languages</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">_languages</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
            <span class="n">all_stopwords</span> <span class="o">=</span> <span class="n">get_stopwords</span><span class="p">()</span>
            <span class="n">languages</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">_languages</span><span class="o">.</span><span class="n">data</span>

            <span class="k">for</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">languages</span><span class="o">.</span><span class="n">list_data</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_stopwords</span><span class="o">.</span><span class="n">fileids</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Invalid language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">. Available: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_stopwords</span><span class="o">.</span><span class="n">fileids</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
                <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">language</span><span class="p">))</span>

        <span class="n">_stopword_lists</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;stopword_lists&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_stopword_lists</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
            <span class="n">stopword_lists</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">_stopword_lists</span><span class="o">.</span><span class="n">data</span>
            <span class="k">for</span> <span class="n">stopword_list</span> <span class="ow">in</span> <span class="n">stopword_lists</span><span class="o">.</span><span class="n">list_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">stopwords</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">)</span>

        <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;stopwords_list&quot;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">stopwords</span><span class="p">))</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;languages&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of languages, will be used to retrieve language-specific stopword from nltk.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;stopword_lists&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of lists of stopwords.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;stopwords_list&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A sorted list of unique stopwords.&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.AssembleStopwordsModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">_languages</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_languages</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
        <span class="n">all_stopwords</span> <span class="o">=</span> <span class="n">get_stopwords</span><span class="p">()</span>
        <span class="n">languages</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">_languages</span><span class="o">.</span><span class="n">data</span>

        <span class="k">for</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">languages</span><span class="o">.</span><span class="n">list_data</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_stopwords</span><span class="o">.</span><span class="n">fileids</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">. Available: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_stopwords</span><span class="o">.</span><span class="n">fileids</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">language</span><span class="p">))</span>

    <span class="n">_stopword_lists</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;stopword_lists&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_stopword_lists</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
        <span class="n">stopword_lists</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">_stopword_lists</span><span class="o">.</span><span class="n">data</span>
        <span class="k">for</span> <span class="n">stopword_list</span> <span class="ow">in</span> <span class="n">stopword_lists</span><span class="o">.</span><span class="n">list_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">stopwords</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">stopword_list</span><span class="p">)</span>

    <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;stopwords_list&quot;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">stopwords</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule" class="doc doc-heading">
        <code>
PreprocessModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Preprocess lists of tokens, incl. lowercasing, remove special characers, etc.</p>
<p>Lowercasing: Lowercase the words. This operation is a double-edged sword. It can be effective at yielding potentially better results in the case of relatively small datasets or datatsets with a high percentage of OCR mistakes. For instance, if lowercasing is not performed, the algorithm will treat USA, Usa, usa, UsA, uSA, etc. as distinct tokens, even though they may all refer to the same entity. On the other hand, if the dataset does not contain such OCR mistakes, then it may become difficult to distinguish between homonyms and make interpreting the topics much harder.</p>
<p>Removing stopwords and words with less than three characters: Remove low information words. These are typically words such as articles, pronouns, prepositions, conjunctions, etc. which are not semantically salient. There are numerous stopword lists available for many, though not all, languages which can be easily adapted to the individual researcher's needs. Removing words with less than three characters may additionally remove many OCR mistakes. Both these operations have the dual advantage of yielding more reliable results while reducing the size of the dataset, thus in turn reducing the required processing power. This step can therefore hardly be considered optional in TM.</p>
<p>Noise removal: Remove elements such as punctuation marks, special characters, numbers, html formatting, etc. This operation is again concerned with removing elements that may not be relevant to the text analysis and in fact interfere with it. Depending on the dataset and research question, this operation can become essential.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PreprocessModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Preprocess lists of tokens, incl. lowercasing, remove special characers, etc.</span>

<span class="sd">    Lowercasing: Lowercase the words. This operation is a double-edged sword. It can be effective at yielding potentially better results in the case of relatively small datasets or datatsets with a high percentage of OCR mistakes. For instance, if lowercasing is not performed, the algorithm will treat USA, Usa, usa, UsA, uSA, etc. as distinct tokens, even though they may all refer to the same entity. On the other hand, if the dataset does not contain such OCR mistakes, then it may become difficult to distinguish between homonyms and make interpreting the topics much harder.</span>

<span class="sd">    Removing stopwords and words with less than three characters: Remove low information words. These are typically words such as articles, pronouns, prepositions, conjunctions, etc. which are not semantically salient. There are numerous stopword lists available for many, though not all, languages which can be easily adapted to the individual researcher&#39;s needs. Removing words with less than three characters may additionally remove many OCR mistakes. Both these operations have the dual advantage of yielding more reliable results while reducing the size of the dataset, thus in turn reducing the required processing power. This step can therefore hardly be considered optional in TM.</span>

<span class="sd">    Noise removal: Remove elements such as punctuation marks, special characters, numbers, html formatting, etc. This operation is again concerned with removing elements that may not be relevant to the text analysis and in fact interfere with it. Depending on the dataset and research question, this operation can become essential.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;preprocess.tokens_array&quot;</span>

    <span class="n">KIARA_METADATA</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tokens&quot;</span><span class="p">,</span> <span class="s2">&quot;preprocess&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokens array to pre-process.&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;to_lowercase&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Apply lowercasing to the text.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;remove_alphanumeric&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that include numbers (e.g. ex1ample).&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;remove_non_alpha&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that include punctuation and numbers (e.g. ex1a.mple).&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;remove_all_numeric&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that contain numbers only (e.g. 876).&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;remove_short_tokens&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove tokens shorter than a certain length. If value is &lt;= 0, no filtering will be done.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;remove_stopwords&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove stopwords.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The pre-processed content, as an array of lists of strings.&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

        <span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
        <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

        <span class="n">tokens_array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>
        <span class="n">lowercase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;to_lowercase&quot;</span><span class="p">)</span>
        <span class="n">remove_alphanumeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_alphanumeric&quot;</span><span class="p">)</span>
        <span class="n">remove_non_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_non_alpha&quot;</span><span class="p">)</span>
        <span class="n">remove_all_numeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_all_numeric&quot;</span><span class="p">)</span>
        <span class="n">remove_short_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_short_tokens&quot;</span><span class="p">)</span>

        <span class="n">_remove_stopwords</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;remove_stopwords&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_remove_stopwords</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
            <span class="n">stopword_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_remove_stopwords</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">list_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stopword_list</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># it&#39;s better to have one method every token goes through, then do every test seperately for the token list</span>
        <span class="c1"># because that way each token only needs to be touched once (which is more effective)</span>
        <span class="k">def</span> <span class="nf">check_token</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

            <span class="c1"># remove short tokens first, since we can save ourselves all the other checks (which are more expensive)</span>
            <span class="k">if</span> <span class="n">remove_short_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">remove_short_tokens</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="n">_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">token</span>
            <span class="k">if</span> <span class="n">lowercase</span><span class="p">:</span>
                <span class="n">_token</span> <span class="o">=</span> <span class="n">_token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="n">_token</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="c1"># if remove_non_alpha was set, we don&#39;t need to worry about tokens that include numbers, since they are already filtered out</span>
            <span class="k">if</span> <span class="n">remove_alphanumeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="n">_token</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="c1"># all-number tokens are already filtered out if the remove_non_alpha methods above ran</span>
            <span class="k">if</span> <span class="n">remove_all_numeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">_token</span>
                <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">stopword_list</span> <span class="ow">and</span> <span class="n">_token</span> <span class="ow">and</span> <span class="n">_token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">stopword_list</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="n">_token</span>

        <span class="c1"># the following doesn&#39;t work due to bug: https://github.com/pola-rs/polars/issues/3867</span>
        <span class="c1"># replace current code once that is fixed</span>
        <span class="c1"># series = pl.Series(name=&quot;tokens&quot;, values=tokens_array.arrow_array)</span>
        <span class="c1"># result = series.apply(lambda token_list: [</span>
        <span class="c1">#         x for x in (check_token(token) for token in token_list) if x is not None</span>
        <span class="c1">#     ])</span>
        <span class="c1"># print(result.dtype)</span>
        <span class="c1">#</span>
        <span class="c1"># result_array = result.to_arrow()</span>
        <span class="c1">#</span>
        <span class="c1"># # TODO: remove this cast once the array data type can handle non-chunked arrays</span>
        <span class="c1"># chunked = pa.chunked_array(result_array)</span>
        <span class="c1"># outputs.set_values(tokens_array=chunked)</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">tokens_array</span><span class="o">.</span><span class="n">arrow_array</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tokens&quot;</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">check_tokens</span><span class="p">(</span><span class="n">token_list</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">check_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">token_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">check_tokens</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;column_0&quot;</span><span class="p">)</span>

        <span class="n">array</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
        <span class="n">chunked</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">tokens_array</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule.KIARA_METADATA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KIARA_METADATA</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule.KIARA_METADATA" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>




<h6 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokens array to pre-process.&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;to_lowercase&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Apply lowercasing to the text.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;remove_alphanumeric&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that include numbers (e.g. ex1ample).&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;remove_non_alpha&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that include punctuation and numbers (e.g. ex1a.mple).&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;remove_all_numeric&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove all tokens that contain numbers only (e.g. 876).&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;remove_short_tokens&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove tokens shorter than a certain length. If value is &lt;= 0, no filtering will be done.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;remove_stopwords&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Remove stopwords.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The pre-processed content, as an array of lists of strings.&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.PreprocessModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.PreprocessModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

    <span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
    <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

    <span class="n">tokens_array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>
    <span class="n">lowercase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;to_lowercase&quot;</span><span class="p">)</span>
    <span class="n">remove_alphanumeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_alphanumeric&quot;</span><span class="p">)</span>
    <span class="n">remove_non_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_non_alpha&quot;</span><span class="p">)</span>
    <span class="n">remove_all_numeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_all_numeric&quot;</span><span class="p">)</span>
    <span class="n">remove_short_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;remove_short_tokens&quot;</span><span class="p">)</span>

    <span class="n">_remove_stopwords</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;remove_stopwords&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_remove_stopwords</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
        <span class="n">stopword_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_remove_stopwords</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">list_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">stopword_list</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># it&#39;s better to have one method every token goes through, then do every test seperately for the token list</span>
    <span class="c1"># because that way each token only needs to be touched once (which is more effective)</span>
    <span class="k">def</span> <span class="nf">check_token</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

        <span class="c1"># remove short tokens first, since we can save ourselves all the other checks (which are more expensive)</span>
        <span class="k">if</span> <span class="n">remove_short_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">remove_short_tokens</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="n">_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">token</span>
        <span class="k">if</span> <span class="n">lowercase</span><span class="p">:</span>
            <span class="n">_token</span> <span class="o">=</span> <span class="n">_token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">_token</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># if remove_non_alpha was set, we don&#39;t need to worry about tokens that include numbers, since they are already filtered out</span>
        <span class="k">if</span> <span class="n">remove_alphanumeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">_token</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># all-number tokens are already filtered out if the remove_non_alpha methods above ran</span>
        <span class="k">if</span> <span class="n">remove_all_numeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">remove_non_alpha</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">_token</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">_token</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">stopword_list</span> <span class="ow">and</span> <span class="n">_token</span> <span class="ow">and</span> <span class="n">_token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">stopword_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">_token</span>

    <span class="c1"># the following doesn&#39;t work due to bug: https://github.com/pola-rs/polars/issues/3867</span>
    <span class="c1"># replace current code once that is fixed</span>
    <span class="c1"># series = pl.Series(name=&quot;tokens&quot;, values=tokens_array.arrow_array)</span>
    <span class="c1"># result = series.apply(lambda token_list: [</span>
    <span class="c1">#         x for x in (check_token(token) for token in token_list) if x is not None</span>
    <span class="c1">#     ])</span>
    <span class="c1"># print(result.dtype)</span>
    <span class="c1">#</span>
    <span class="c1"># result_array = result.to_arrow()</span>
    <span class="c1">#</span>
    <span class="c1"># # TODO: remove this cast once the array data type can handle non-chunked arrays</span>
    <span class="c1"># chunked = pa.chunked_array(result_array)</span>
    <span class="c1"># outputs.set_values(tokens_array=chunked)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">tokens_array</span><span class="o">.</span><span class="n">arrow_array</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tokens&quot;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_tokens</span><span class="p">(</span><span class="n">token_list</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">check_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">token_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">check_tokens</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;column_0&quot;</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
    <span class="n">chunked</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">tokens_array</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule" class="doc doc-heading">
        <code>
RemoveStopwordsModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Remove stopwords from an array of token-lists.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RemoveStopwordsModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove stopwords from an array of token-lists.&quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;remove_stopwords.from.tokens_array&quot;</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="c1"># TODO: do something smart and check whether languages are already downloaded, if so, display selection in doc</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of string lists (a list of tokens).&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;languages&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="c1"># &quot;doc&quot;: f&quot;A list of language names to use default stopword lists for. Available: {&#39;, &#39;.join(get_stopwords().fileids())}.&quot;,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of language names to use default stopword lists for.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;additional_stopwords&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of additional, custom stopwords.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">inputs</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of string lists, with the stopwords removed.&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

        <span class="n">custom_stopwords</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;additional_stopwords&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
            <span class="n">_languages</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="n">_languages</span><span class="o">.</span><span class="n">list_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">languages</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">fileids</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Invalid language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">. Available: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">fileids</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
                <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">language</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">custom_stopwords</span><span class="p">:</span>
            <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">custom_stopwords</span><span class="p">)</span>

        <span class="n">orig_array</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">stopwords</span><span class="p">:</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">,</span> <span class="n">orig_array</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># if hasattr(orig_array, &quot;to_pylist&quot;):</span>
        <span class="c1">#     token_lists = orig_array.to_pylist()</span>

        <span class="n">tokens_array</span> <span class="o">=</span> <span class="n">orig_array</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">arrow_array</span>

        <span class="c1"># TODO: use vaex for this</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">token_list</span> <span class="ow">in</span> <span class="n">tokens_array</span><span class="p">:</span>

            <span class="n">cleaned_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">token_list</span><span class="o">.</span><span class="n">as_py</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">]</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cleaned_list</span><span class="p">)</span>

        <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="c1"># TODO: do something smart and check whether languages are already downloaded, if so, display selection in doc</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of string lists (a list of tokens).&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;languages&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="c1"># &quot;doc&quot;: f&quot;A list of language names to use default stopword lists for. Available: {&#39;, &#39;.join(get_stopwords().fileids())}.&quot;,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of language names to use default stopword lists for.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;additional_stopwords&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of additional, custom stopwords.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of string lists, with the stopwords removed.&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.RemoveStopwordsModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

    <span class="n">custom_stopwords</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;additional_stopwords&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
        <span class="n">_languages</span><span class="p">:</span> <span class="n">ListModel</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;languages&quot;</span><span class="p">)</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">_languages</span><span class="o">.</span><span class="n">list_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">languages</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">fileids</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">. Available: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">fileids</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_stopwords</span><span class="p">()</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">language</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">custom_stopwords</span><span class="p">:</span>
        <span class="n">stopwords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">custom_stopwords</span><span class="p">)</span>

    <span class="n">orig_array</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">stopwords</span><span class="p">:</span>
        <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">,</span> <span class="n">orig_array</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># if hasattr(orig_array, &quot;to_pylist&quot;):</span>
    <span class="c1">#     token_lists = orig_array.to_pylist()</span>

    <span class="n">tokens_array</span> <span class="o">=</span> <span class="n">orig_array</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">arrow_array</span>

    <span class="c1"># TODO: use vaex for this</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">token_list</span> <span class="ow">in</span> <span class="n">tokens_array</span><span class="p">:</span>

        <span class="n">cleaned_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">token_list</span><span class="o">.</span><span class="n">as_py</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cleaned_list</span><span class="p">)</span>

    <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;tokens_array&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule" class="doc doc-heading">
        <code>
TokenizeTextArrayeModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Split sentences into words or words into characters.
In other words, this operation establishes the word boundaries (i.e., tokens) a very helpful way of finding patterns. It is also the typical step prior to stemming and lemmatization</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TokenizeTextArrayeModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split sentences into words or words into characters.</span>
<span class="sd">    In other words, this operation establishes the word boundaries (i.e., tokens) a very helpful way of finding patterns. It is also the typical step prior to stemming and lemmatization</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;tokenize.texts_array&quot;</span>

    <span class="n">KIARA_METADATA</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tokenize&quot;</span><span class="p">,</span> <span class="s2">&quot;tokens&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;texts_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of text items to be tokenized.&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;tokenize_by_word&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Whether to tokenize by word (default), or character.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokenized content, as an array of lists of strings.&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

        <span class="k">pass</span>

        <span class="kn">import</span> <span class="nn">nltk</span>
        <span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
        <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

        <span class="n">array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;texts_array&quot;</span><span class="p">)</span>
        <span class="c1"># tokenize_by_word: bool = inputs.get_value_data(&quot;tokenize_by_word&quot;)</span>

        <span class="n">column</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">ChunkedArray</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">arrow_array</span>

        <span class="c1"># warnings.filterwarnings(&quot;ignore&quot;, category=np.VisibleDeprecationWarning)</span>

        <span class="c1"># the following doesn&#39;t work due to bug: https://github.com/pola-rs/polars/issues/3867</span>
        <span class="c1"># replace current code once that is fixed</span>
        <span class="c1"># def word_tokenize(word):</span>
        <span class="c1">#     result = nltk.word_tokenize(word)</span>
        <span class="c1">#     return result</span>
        <span class="c1">#</span>
        <span class="c1"># series = pl.Series(name=&quot;tokens&quot;, values=column)</span>
        <span class="c1"># result = series.apply(word_tokenize)</span>
        <span class="c1"># print(result.dtype)</span>
        <span class="c1">#</span>
        <span class="c1"># result_array = result.to_arrow()</span>
        <span class="c1">#</span>
        <span class="c1"># # TODO: remove this cast once the array data type can handle non-chunked arrays</span>
        <span class="c1"># chunked = pa.chunked_array(result_array)</span>
        <span class="c1"># outputs.set_values(tokens_array=chunked)</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tokens&quot;</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">word_tokenize</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,)</span>

        <span class="n">result</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">word_tokenize</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">inner</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;column_0&quot;</span><span class="p">)</span>

        <span class="n">array</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
        <span class="n">chunked</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">tokens_array</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.KIARA_METADATA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KIARA_METADATA</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.KIARA_METADATA" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>




<h6 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;texts_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An array of text items to be tokenized.&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;tokenize_by_word&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Whether to tokenize by word (default), or character.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;tokens_array&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokenized content, as an array of lists of strings.&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextArrayeModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">):</span>

    <span class="k">pass</span>

    <span class="kn">import</span> <span class="nn">nltk</span>
    <span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
    <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

    <span class="n">array</span><span class="p">:</span> <span class="n">KiaraArray</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;texts_array&quot;</span><span class="p">)</span>
    <span class="c1"># tokenize_by_word: bool = inputs.get_value_data(&quot;tokenize_by_word&quot;)</span>

    <span class="n">column</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">ChunkedArray</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">arrow_array</span>

    <span class="c1"># warnings.filterwarnings(&quot;ignore&quot;, category=np.VisibleDeprecationWarning)</span>

    <span class="c1"># the following doesn&#39;t work due to bug: https://github.com/pola-rs/polars/issues/3867</span>
    <span class="c1"># replace current code once that is fixed</span>
    <span class="c1"># def word_tokenize(word):</span>
    <span class="c1">#     result = nltk.word_tokenize(word)</span>
    <span class="c1">#     return result</span>
    <span class="c1">#</span>
    <span class="c1"># series = pl.Series(name=&quot;tokens&quot;, values=column)</span>
    <span class="c1"># result = series.apply(word_tokenize)</span>
    <span class="c1"># print(result.dtype)</span>
    <span class="c1">#</span>
    <span class="c1"># result_array = result.to_arrow()</span>
    <span class="c1">#</span>
    <span class="c1"># # TODO: remove this cast once the array data type can handle non-chunked arrays</span>
    <span class="c1"># chunked = pa.chunked_array(result_array)</span>
    <span class="c1"># outputs.set_values(tokens_array=chunked)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tokens&quot;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">word_tokenize</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,)</span>

    <span class="n">result</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">word_tokenize</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">inner</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;column_0&quot;</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
    <span class="n">chunked</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">chunked_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">outputs</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">tokens_array</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig" class="doc doc-heading">
        <code>
TokenizeTextConfig            (<a class="autorefs autorefs-external" title="kiara.models.module.KiaraModuleConfig" href="https://dharpa.org/kiara/latest/reference/kiara/models/module/__init__/#kiara.models.module.KiaraModuleConfig">KiaraModuleConfig</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TokenizeTextConfig</span><span class="p">(</span><span class="n">KiaraModuleConfig</span><span class="p">):</span>

    <span class="n">filter_non_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to filter out non alpha tokens.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">min_token_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The minimum token length.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">to_lowercase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to lowercase the tokens.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig-attributes">Attributes<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig-attributes" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.filter_non_alpha" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_non_alpha</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.filter_non_alpha" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Whether to filter out non alpha tokens.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.min_token_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">min_token_length</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.min_token_length" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>The minimum token length.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.to_lowercase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_lowercase</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextConfig.to_lowercase" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Whether to lowercase the tokens.</p>
    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule" class="doc doc-heading">
        <code>
TokenizeTextModule            (<a class="autorefs autorefs-external" title="kiara.modules.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/__init__/#kiara.modules.KiaraModule">KiaraModule</a>)
        </code>



<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Tokenize a string.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TokenizeTextModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tokenize a string.&quot;&quot;&quot;</span>

    <span class="n">_config_cls</span> <span class="o">=</span> <span class="n">TokenizeTextConfig</span>
    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;tokenize.string&quot;</span>

    <span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The text to tokenize.&quot;</span><span class="p">}}</span>

        <span class="k">return</span> <span class="n">inputs</span>

    <span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;token_list&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokenized version of the input text.&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="kn">import</span> <span class="nn">nltk</span>

        <span class="c1"># TODO: module-independent caching?</span>
        <span class="c1"># language = inputs.get_value_data(&quot;language&quot;)</span>
        <span class="c1">#</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
        <span class="n">tokenized</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">tokenized</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;min_token_length&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">x</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tokenized</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;min_token_length&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;filter_non_alpha&quot;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">isalpha</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;to_lowercase&quot;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;token_list&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">





<h6 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-classes">Classes<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-classes" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-class">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls" class="doc doc-heading">
        <code>
_config_cls            (<a class="autorefs autorefs-external" title="kiara.models.module.KiaraModuleConfig" href="https://dharpa.org/kiara/latest/reference/kiara/models/module/__init__/#kiara.models.module.KiaraModuleConfig">KiaraModuleConfig</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-private"><code>private</code></small>
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TokenizeTextConfig</span><span class="p">(</span><span class="n">KiaraModuleConfig</span><span class="p">):</span>

    <span class="n">filter_non_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to filter out non alpha tokens.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">min_token_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The minimum token length.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">to_lowercase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to lowercase the tokens.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h8 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls-attributes">Attributes<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls-attributes" class="headerlink" title="Permanent link">&para;</a></h8>

  <div class="doc doc-object doc-attribute">



<h9 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.filter_non_alpha" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_non_alpha</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.filter_non_alpha" class="headerlink" title="Permanent link">&para;</a></h9>

    <div class="doc doc-contents ">

      <p>Whether to filter out non alpha tokens.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.min_token_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">min_token_length</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.min_token_length" class="headerlink" title="Permanent link">&para;</a></h9>

    <div class="doc doc-contents ">

      <p>The minimum token length.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.to_lowercase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_lowercase</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule._config_cls.to_lowercase" class="headerlink" title="Permanent link">&para;</a></h9>

    <div class="doc doc-contents ">

      <p>Whether to lowercase the tokens.</p>
    </div>

  </div>








  </div>

    </div>

  </div>



<h6 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-methods">Methods<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.create_inputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' inputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The text to tokenize.&quot;</span><span class="p">}}</span>

    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.create_outputs_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the schema for this types' outputs.</p>

        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueSetSchema</span><span class="p">:</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;token_list&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The tokenized version of the input text.&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.TokenizeTextModule.process" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">nltk</span>

    <span class="c1"># TODO: module-independent caching?</span>
    <span class="c1"># language = inputs.get_value_data(&quot;language&quot;)</span>
    <span class="c1">#</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="n">tokenized</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">tokenized</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;min_token_length&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">x</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tokenized</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;min_token_length&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;filter_non_alpha&quot;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">isalpha</span><span class="p">())</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;to_lowercase&quot;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

    <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;token_list&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="kiara_plugin.language_processing.modules.tokens.get_stopwords" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_stopwords</span><span class="p">()</span></code>


<a href="#kiara_plugin.language_processing.modules.tokens.get_stopwords" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>language_processing/modules/tokens.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_stopwords</span><span class="p">():</span>

    <span class="c1"># TODO: make that smarter</span>
    <span class="kn">import</span> <span class="nn">nltk</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;punkt&quot;</span><span class="p">,</span> <span class="n">print_error_to</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
    <span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;stopwords&quot;</span><span class="p">,</span> <span class="n">print_error_to</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;external.message&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;nltk&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
    <span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>

    <span class="k">return</span> <span class="n">stopwords</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../models/" class="md-footer__link md-footer__link--prev" aria-label="Previous: models" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              models
            </div>
          </div>
        </a>
      
      
        
        <a href="../lda/" class="md-footer__link md-footer__link--next" aria-label="Next: lda" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              lda
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking"], "search": "../../../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.0238f547.min.js"></script>
      
    
  </body>
</html>