{
  "module_type_name": "topic_modeling",
  "doc": "Topic modelling dev pipeline.",
  "steps": [
    {
      "module_type": "onboarding.import_local_folder",
      "step_id": "read_files_in_folder"
    },
    {
      "module_type": "tabular.create_table_from_text_files",
      "module_config": {
        "columns": ["id", "rel_path", "file_name", "content"]
      },
      "step_id": "create_table",
      "input_links": {
        "files": "read_files_in_folder.file_bundle"
      }
    },
    {
      "module_type": "arrays.map",
      "module_config": {
        "module_type": "dates.extract_date"
      },
      "step_id": "extract_date",
      "input_links": {
        "array": "create_table.table.file_name"
      }
    },
    {
      "module_type": "arrays.map",
      "module_config": {
        "module_type": "strings.match_regex",
        "module_config": {
          "regex": "(\\w+\\d+)_\\d{4}-\\d{2}-\\d{2}_",
          "only_first_match": true
        }
      },
      "step_id": "extract_ref",
      "input_links": {
        "array": "create_table.table.file_name"
      }
    },
    {
      "module_type": "arrays.map",
      "module_config": {
        "module_type": "strings.replace_string",
        "module_config": {
          "replacement_map": {
            "sn85066408": "L\\'Italia",
            "2012271201": "Cronaca Sovversiva"
          }
        }
      },
      "step_id": "get_publication_name",
      "input_links": {
        "array": "extract_ref.array"
      }
    },
    {
      "module_type": "tabular.merge_table",
      "step_id": "merged_table",
      "input_links": {
        "sources": [
          "create_table.table",
          "extract_date.array",
          "extract_ref.array",
          "get_publication_name.array"
        ]
      }
    },
    {
      "module_type": "arrays.map",
      "module_config": {
        "module_type": "dates.date_range_check",
        "input_name": "date"
      },
      "step_id": "create_date_range_filter",
      "input_links": {
        "array": "extract_date"
      }
    },
    {
      "module_type": "tabular.filter_table",
      "step_id": "filtered_table",
      "input_links": {
        "table": "merged_table.table",
        "mask": "create_date_range_filter.array"
      }
    },
    {
      "module_type": "arrays.map",
      "module_config": {
        "module_type": "language.tokens.tokenize_text",
        "input_name": "text"
      },
      "step_id": "tokenize_text_corpus",
      "input_links": {
        "array": "filtered_table.table.content"
      }
    },
    {
      "module_type": "language.tokens.remove_stopwords",
      "step_id": "remove_stopwords",
      "input_links": {
        "token_lists": "tokenize_text_corpus.array"
      }
    },
    {
      "module_type": "language.lemmatize.tokens_array",
      "step_id": "lemmatize",
      "input_links": {
        "tokens_array": "remove_stopwords.token_list"
      }
    },
    {
      "module_type": "language.lda.LDA",
      "step_id": "lda",
      "input_links": {
        "tokens_array": "lemmatize.tokens_array"
      }
    }
  ],
  "input_aliases": "auto",
  "output_aliases": "auto"
}

